int generate_key(int bits, char *buffer, int buffer_size);